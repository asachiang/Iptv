- name: Generate categorized playlists
        run: |
          make_list () {
            output=$1
            shift
            keywords=("$@")

            echo "#EXTM3U" > "$output"

            for key in "${keywords[@]}"; do
              awk -v k="$key" '
                $0 ~ k {
                  print prev
                  print
                  getline
                  print
                }
                { prev=$0 }
              ' 4gtv.m3u >> "$output"
            done
          }

          make_list 4gtv-news.m3u \
            "新聞" "TVBS" "中天" "三立" "東森" "年代" "寰宇"

          make_list 4gtv-general.m3u \
            "台視" "中視" "華視" "民視" "公視" "八大" "緯來"

          make_list 4gtv-kids.m3u \
            "YOYO" "MOMO" "卡通" "兒童" "Disney"